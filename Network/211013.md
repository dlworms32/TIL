# 서버의 이해
## 1. 서버의 구성
* 서버
  * 클라이언트들이 접속하여 쓸 수 있는 시스템
  * 대부분 무중단 운영
  * 대용량 트래픽 처리
* 특정 역할의 서버
  * 웹서버 : 클라이언트에게 HTTP 문서를 전달해주는 서버
  * DB 서버 : 클라이언트의 데이터를 관리
  * 게임 서버 : 클라이언트의 게임 데이터 관리 및 처리
* 로드밸런싱
  * 웹 서버 한대가 처리할 수 있는 트래픽
  * 접속자가 많아지면 성능 이슈 발생
    * 네트워크 회선 문제
    * SSD Read 성능 문제
  * 웹 서버 여러개를 L4 스위치로 연결하면 속도가 3배 빨라짐
    * 클라이언트들을 분할
    * 하나의 웹 서버가 죽었을 때 무중단 운영 가능
## 2. 클라우드 시대
* 무중단 운용
  * 서버는 무중단 운용이 기본
  * 고장이 발생하지 않아야 함 (적정 온/습도 유지)
  * bps 및 트래픽이 좋아야 함
  * 정전으로 전력이 나가는 일이 없어야 함 (UPS 설치)
* 전산실 운영
  * 서버 관리자
  * 서버 랙 관리
    * 안정적인 전원 광급
    * 먼지 관리
  * 문제점
    * 특정 일에 트래픽이 몰리는 경우 대응이 힘듦
* 코로케이션 (IDC 입주 서비스)
  * 전산실 대여 서비스
  * 전산실 필수 도구 완비
    * 빠른 전용선
    * 안정적 전력
    * 방화벽 및 백업 서비스
* 가상화 기술
  * 고성능 컴퓨터에서 시뮬레이션 SW 컴퓨터 생성
  * 실제 컴퓨터와 똑같이 동작
* 클라우드 서비스의 시작
  * 소비자가 서비스 신청시 컴퓨터를 하나 만들어 대여
  * 서버용/개인용 PC로 활용 가능
* 클라우드의 정의
  * 인터넷을 이용, 가상화된 시스템 리소스를 사용할 수 있음
  * 자신의 컴퓨터가 아닌, 서버 컴퓨터 자원을 사용하는 기술
  * 전산 운영, 인력 비용을 줄일 수 있음
* IaaS (Infrastrucure as a Service)
  * 클라우드의 서비스 유형 중 하나
  * 컴퓨팅 시스템을 가상화 환경으로 만들어 서비스를 제공해주는 방식(AWS EC2)
* Paas (Platform as a Service)
  * 바꿀 수 없는 기본 시스템이 구축된 상태에서 App 개발 / 배포 / DB 관리 가능(Google App Engine)
* Saas (Software as a Service)
  * 서버에서 호스팅 방식으로 서비스 제공 (Office 365, Dropbox, 네이버 클라우드)
* Auto Scailing
  * 장비 없이 장비 세팅이 편함
  * 로드 밸런싱이 몇 번의 클릭으로 이뤄짐
  * 이용자에 따라 서버의 개수 자동 조절
# Socket 통신
## 1. Socket 통신 개요
* Socket의 역할
  * 소켓 내부를 몰라도 인터페이스만 맞추면 통신 가능
* Socket의 특징
  * 통신을 위해 통신 프로토콜 지정
  * 목적지의 IP / Port을 알아야 통신 가능
  * 리눅스 커널은 소켓을 파일로 관리
  * 한 포트당, 하나의 소켓 통신 가능
## 2. Socket Server / Client 제작
* Socket 사용 Sequence (서버)
  1. `socket()` : 통신 프로토콜 지정, Socket 파일 디스크립터 생성
  2. `bind()` : IP / Port 바인딩
  3. `listen()` : 소켓 상태를 listen으로 변경
  4. `accept()` : Blocking 함수, 연결 수행 후 클라이언트 소켓 파일 디스크립터 생성
* Socket 사용 Sequence (클라이언트)
  1. `socket()` : 통신 프로토콜 지정, Socket 파일 디스크립터 생성
  2. `connect()` : blocking으로 서버 접속 대기
## 3. 채팅 프로그램 제작
* 메시지 전달 서버
  * 서버들은 채팅 서버와 원리가 같음
  * 채팅 프로그램을 응용해 다양한 서버 제작 가능
    * 웹 서버
    * 파일 서버
    * 게임 서버
    * DB 서버 등
* [1:1 채팅 프로그램 제작](https://github.com/dlworms32/TIL/tree/master/Network/%EC%B1%84%ED%8C%85%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8)
  * 요구사항
    * 서버와 클라이언트가 서로 Read / Write 가능
    * 서버를 끄면 클라이언트도 꺼짐
    * 클라이언트가 종료되어도, 서버는 꺼지지 않음
    * 클라이언트가 다시 접속하면 채팅이 이뤄짐
# Router
## 1. Unicast와 Broadcast
* 유니캐스트와 브로드캐스트
  * 같은 네트워크에서 메세지 전달 방법
  * 유니캐스트 : 한 노드에게만 전달
  * 브로드캐스트 : 모든 노드에게 전달
  * 멀티캐스트 : 그룹으로 묶은 후 해당 그룹에게만 전달
* 허브에서 유니캐스트
  * 1:1 데이터 전달 방식
  * 데이터 출발지, 도착지를 저장 (MAC 주소 저장)
  * LAN은 모든 네트워크에 신호를 전달, 자신의 메시지가 아닌 경우 무시
* 스위치에서 유니캐스트
  * MAC Address Table을 이용
  * 메시지를 보낸 노드의 MAC 주소 저장
  * 도착지 MAC 주소 확인 후, 해당 포트에만 메시지 전송
  * MAC Table에 없을 경우 브로드캐스팅으로 전체 노드에 전송
## 2.ARP(Address Resolution Protocol)
* ARP
  * IP만으로 MAC 주소를 찾을 때 사용하는 프로토콜
* 동작 방식
  1. 전체 브로드캐스팅 (ARP Request)
  2. Target노드가 MAC 주소를 담아 응답
  3. 브로드캐스트는 라우터가 차단, 다른 네트워크로 넘어가지 않음
* 단점
  * ARP는 CPU가 처리
  * 인터럽트 발생 후, 자신의 IP주소와 일치하는지 확인 -> PC 성능 저하
  * 스위치를 사용, 콜리젼을 차단가능
## 3. Router
* PC가 많을수록
  * 브로드 캐스팅 자주 발생 -> 콜리전 발생 가능성 높아짐
  * ARP Request가 많아짐
  * 네트워크 분할 필요
* 라우터
  * 스위치와 달리 복잡한 Firmware로 동작
* 라우터의 역할
  * Gateway : 서로 다른 네트워크 통신 목적
  * 브로드캐스팅 영역을 나눔
  * 라우터끼리 연결되어있을 때, 지능적 배정가능
# OSI 7 Layer
## 1. OSI 7 Layer 개요
* OSI 7 Layer
  * ISO 에서 정한 통신의 추상화 단계
  * 통신은 H/W + S/W 모두 필요
  * 통신에 필요한 동작을 7단계로 나눔
* OSI 7 Layer Model
  * Application Layer
  * Presentation Layer
  * Session Layer
  * Transport Layer
  * Network Layer
  * Data Link Layer
  * Physical Layer
* 신호 전달 과정
  * App -> App까지
  * 과정을 계층별로 생략 가능
## 2. Data 관점에서 OSI 7 Layer
* App Layer부터 시작
  * 각 단계별로 헤더 정보를 하나씩 추가함
  * 프레임 : 최종적으로 만들어진 데이터
* Data Link Layer
  * MAC 주소 추가
  * 프레임이 만들어짐
* Network Layer
  * IP 주소 추가
  * 패킷이 만들어짐
* Transport Layer
  * 오류 관련, 속도, 포트번호 추가
* Session Layer (사용되지 않는 경우도 있음)
  * 통신 동기화 정보 
* Presentation Layer (사용되지 않는 경우도 있음)
  * 데이터 압축 / 암호화 정보
* Application Layer
  * 사용자 데이터
## 2. H/W 측면의 OSI 7 Layer
* L1 장비
  * 전기적 신호를 처리 
  * 허브, NIC, UTP 케이블
* L2 장비
  * Data들의 Link
  * LAN 영역의 Data 정보 전달 (ethernet, MAC 연관)
  * L2 스위치
* L3 장비
  * 네트워크 데이터 전달 (IP 확인)
  * L3 스위치
* L4 장비
  * IP, TCP 포트 확인, IP를 수정하여 경로 변경
  * L4 스위치
  * 로드밸런싱
* L7 장비
  * URL / 쿠키 등을 확인하여 로드밸런싱 가능
  * L7 스위치
# IP / Subnetting
## 1. IP 주소
* 공인 IP
  * ICANN 조직, 아래 5개(대륙마다)의 RIR로 나누어 관리
  * 한국은 KRNIC
* IP주소 구조
  * Network Part + Host Part
  * 브로드캐스팅 영역에 있는 노드들은 Network Part가 모두 같은 값을 가짐
  * Host Part는 모두 다름
* 공인 IP Class
  * 네트워크 크기에 따라 Class 분류 (A ~ E)
  * A class
    * `127.0.0.1` 이전 IP 주소
    * 네트워크 주소 : 앞 8bit  
    * 호스트 주소 : 뒤 24bit
  * B class
    * `128.0.0.1` ~ `191.255.0.0`
    * 네트워크 주소 : 앞 16bit  
    * 호스트 주소 : 뒤 16bit
  * C class
    * `192.0.0.0` ~ `233.255.255.0`
    * 네트워크 주소 : 앞 24bit  
    * 호스트 주소 : 뒤 8bit
* 사설 IP
  * 국제 표준으로 정한 사설 IP주소
  * 네트워크 관리자가 직접 할당
    | 사설 IP 주소 대역 | 주소 개수 |
    | - | - |
    | 10.0.0.0 | 16,777,216 |
    | 172.16~31.0.0 | 1,048,576 |
    | 192.168.0.0 | 65536 |
* 사용하지 않는 IP
  * Host 주소의 모든 bit가 0인 주소
    * 네트워크 주소 표기
    * ex) `192.168.0.0`
  * Host 주소의 모든 bit가 1인 주소
    * 브로드캐스트 주소
    * ex) `192.168.255.255`